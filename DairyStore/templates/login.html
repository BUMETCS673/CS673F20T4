{% extends 'index.html' %}
{% block header %}
{% endblock %}
{% block content %}
		<!-- LoginFrame -->
    <script src="https://code.jquery.com/jquery-3.5.1.min.js" integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0=" crossorigin="anonymous"></script>
		<section id="user_banner"></section>
		<div class="login-page">
		  <div class="form">

			 <p id="image_logo"><a href="index.html"><img src="../static/css/images/logo.png"></a></p>
			  {% block form %}
			 <p class = "p1">Welcome Back</p>

			  <form class="login-form" id="form1" action="/login-result" method="POST">
			  <input type="email" name="email" placeholder="Email Address"/>
			  <input type="password" id="password1" name="password" placeholder="Password"/>

			  <div class="eye" id="eye1">
				<i class="far fa-eye" id="fa-eye1"></i>
				<i class="far fa-eye-slash" id="fa-eye-slash1"></i>
			  </div>

			  </form>

			  <p class="p2" href="#">forget password?</p>

			  <button id="login_button" form="form1" type="submit">login</button>
			  <a href="index.html"><button id="cancel_button">cancel</button></a>

			  <div class="line_div">
			  <span class="line"></span>
		      <span class="txt">or</span>
			  <span class="line"></span>
		      </div>

			  <form action="/login" method="POST">
				<button id="google_button" name="google" type="submit"><i class="fab fa-google"></i>Continue with Google</button>
			  </form>
              <button id="facebook_button" name="facebook"><i class="fab fa-facebook"></i>Continue with Facebook</button>
			  <p class="message">Not registered? <a href="register.html">Create an account</a></p>
              <script async defer crossorigin="anonymous" src="https://connect.facebook.net/en_US/sdk.js"></script>
                  <script>
	window.fbAsyncInit = function() {
	  FB.init({
		appId      : '1719991724833550',
		cookie     : true,
		xfbml      : true,
		version    : 'v8.0'
	  });

	  FB.AppEvents.logPageView();

	};

	(function(d, s, id){
	   var js, fjs = d.getElementsByTagName(s)[0];
	   if (d.getElementById(id)) {return;}
	   js = d.createElement(s); js.id = id;
	   js.src = "https://connect.facebook.net/en_US/sdk.js";
	   fjs.parentNode.insertBefore(js, fjs);
	 }(document, 'script', 'facebook-jssdk'));



	// FB.getLoginStatus(function(response) {
	// 	statusChangeCallback(response);
	// });
	function myfbLogin(){
		FB.login(function(response) {
			console.log(response);
			checkLoginState()

		}, {scope: 'public_profile,email'});
	}
	function checkLoginState() {
		FB.getLoginStatus(function(response) {
			// statusChangeCallback(response);
			if (response.status === 'connected') {
				console.log('connected',response);
				// Logged into your webpage and Facebook.
				// checkLoginState();

				FB.api('/me', function(response) {
					console.log(response)
					console.log('Successful login for: ' + response.name);
					$.ajax({
						url:'/authorize',
						method:'POST',
						data:{
							fid:response.id,
							name:response.name
						},
						success:function(){
							window.location.href='index.html';
						}
					})
				});
			} else {
				// The person is not logged into your webpage or we are unable to tell.
			}
		});
	}

	$('#facebook_button').on('click',function(){
		console.log('1');
		myfbLogin();
	})
  </script>

			  </div>
			  {% endblock %}
		  </div>
		</div>

{% endblock %}
