<!DOCTYPE HTML>
<html>
	<head>
		<title>Dairy Farm</title>
		<meta charset="utf-8" />
		<link rel="stylesheet" href="../static/css/main1.css" />
		<script src="https://code.jquery.com/jquery-3.5.1.min.js" integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0=" crossorigin="anonymous"></script>
	</head>
	<body class="landing is-preload">
		<!-- LoginFrame -->
		<div class="login-page">
		  <div class="form">

			 <p id="image_logo"><a href="index.html"><img src="../static/css/images/logo.png"></a></p>
			 <p class = "p1">Welcome Back</p>
			 
			  <form class="login-form" id="form1" action="/login-result" method="POST">
			  <input type="email" name="email" placeholder="Email Address"/>
			  <input type="password" name="password" placeholder="Password"/>
			  </form>
			  
			  <p class="p2" href="#">forget password?</p>
			  
			  <button id="login_button" form="form1" type="submit">login</button>
			  <a href="index.html"><button id="cancel_button">cancel</button></a>
 
			  <div class="line_div">
			  <span class="line"></span>
		      <span class="txt">or</span>
			  <span class="line"></span>
		      </div>
			  <form action="/login" method="POST">
				<button id="google_button" name="google" type="submit"><i class="fab fa-google"></i>Continue with Google</button>
			  	<!-- <button id="facebook_button"  name="facebook"><i class="fab fa-facebook"></i>Continue with Facebook</button> -->
			  </form>
			  <button id="facebook_button"  name="facebook"><i class="fab fa-facebook"></i>Continue with Facebook</button>

			
			  <p class="message">Not registered? <a href="register.html">Create an account</a></p>
			 
			  </div>
			
		  </div>
		</div>

			<!-- Banner -->
				<section id="user_banner"></section>
			<!-- Footer -->
				<footer id="footer">
					<ul class="icons">
						<li><a href="#" class="icon brands fa-twitter"><span class="label">Twitter</span></a></li>
						<li><a href="#" class="icon brands fa-facebook-f"><span class="label">Facebook</span></a></li>
						<li><a href="#" class="icon brands fa-instagram"><span class="label">Instagram</span></a></li>
						<li><a href="#" class="icon brands fa-github"><span class="label">Github</span></a></li>
					</ul>
					<ul class="copyright">
						<li>&copy; Untitled. All rights reserved.</li><li>Design: Dairy Farm</li>
					</ul>
				</footer>

		</div>

		<script async defer crossorigin="anonymous" src="https://connect.facebook.net/en_US/sdk.js"></script>
		
<script>
	window.fbAsyncInit = function() {
	  FB.init({
		appId      : '1719991724833550',
		cookie     : true,
		xfbml      : true,
		version    : 'v8.0'
	  });
		
	  FB.AppEvents.logPageView();   
		
	};
  
	(function(d, s, id){
	   var js, fjs = d.getElementsByTagName(s)[0];
	   if (d.getElementById(id)) {return;}
	   js = d.createElement(s); js.id = id;
	   js.src = "https://connect.facebook.net/en_US/sdk.js";
	   fjs.parentNode.insertBefore(js, fjs);
	 }(document, 'script', 'facebook-jssdk'));


	 
	// FB.getLoginStatus(function(response) {
	// 	statusChangeCallback(response);
	// });
	function myfbLogin(){
		FB.login(function(response) {
			console.log(response);
			checkLoginState()
			
		}, {scope: 'public_profile,email'});
	}
	function checkLoginState() {
		FB.getLoginStatus(function(response) {
			// statusChangeCallback(response);
			if (response.status === 'connected') {
				console.log('connected',response);
				// Logged into your webpage and Facebook.
				// checkLoginState();

				FB.api('/me', function(response) {
					console.log(response)
					console.log('Successful login for: ' + response.name);
					$.ajax({
						url:'/authorize',
						method:'POST',
						data:{
							fid:response.id,
							name:response.name
						},
						success:function(){
							window.location.href='index.html';
						}
					})
				});
			} else {
				// The person is not logged into your webpage or we are unable to tell. 
			}
		});
	}

	$('#facebook_button').on('click',function(){
		console.log('1');
		myfbLogin();
	})
  </script>
	</body>
</html>